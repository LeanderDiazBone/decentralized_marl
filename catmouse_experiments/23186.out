Running on host: studgpu-node01.inf.ethz.ch
In directory: /cluster/courses/3dv/data/team-25/decentralized_marl/catmouse_experiments
Starting on: Thu Jun 27 15:57:36 CEST 2024
SLURM_JOB_ID: 23186
using cuda
episode: 0 | avg score: -50.0 | learning_steps: 0
episode: 100 | avg score: -44.7 | learning_steps: 39
episode: 200 | avg score: -45.5 | learning_steps: 78
episode: 300 | avg score: -45.7 | learning_steps: 116
Traceback (most recent call last):
  File "/cluster/courses/3dv/data/team-25/decentralized_marl/catmouse_experiments/main.py", line 404, in <module>
    train(agent, env, n_games=n_games)
  File "/cluster/courses/3dv/data/team-25/decentralized_marl/catmouse_experiments/main.py", line 352, in train
    agent.learn()
  File "/cluster/courses/3dv/data/team-25/decentralized_marl/catmouse_experiments/agent.py", line 222, in learn
    dists = self.actor(states)
  File "/cluster/courses/3dv/data/team-25/marl_env/marl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/cluster/courses/3dv/data/team-25/marl_env/marl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/cluster/courses/3dv/data/team-25/decentralized_marl/catmouse_experiments/agent.py", line 103, in forward
    dists = [Categorical(dist) for dist in dists]
  File "/cluster/courses/3dv/data/team-25/decentralized_marl/catmouse_experiments/agent.py", line 103, in <listcomp>
    dists = [Categorical(dist) for dist in dists]
  File "/cluster/courses/3dv/data/team-25/marl_env/marl/lib/python3.10/site-packages/torch/distributions/categorical.py", line 70, in __init__
    super().__init__(batch_shape, validate_args=validate_args)
  File "/cluster/courses/3dv/data/team-25/marl_env/marl/lib/python3.10/site-packages/torch/distributions/distribution.py", line 68, in __init__
    raise ValueError(
ValueError: Expected parameter probs (Tensor of shape (128, 9)) of distribution Categorical(probs: torch.Size([128, 9])) to satisfy the constraint Simplex(), but found invalid values:
tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], device='cuda:0',
       grad_fn=<DivBackward0>)
srun: error: studgpu-node01: task 0: Exited with exit code 1
